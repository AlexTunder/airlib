///TODO: make C version in "C" branch